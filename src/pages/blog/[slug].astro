---
// Server-side rendering for dynamic WordPress content
export const prerender = false;

import BaseLayout from '../../layouts/BaseLayout.astro';
import Container from '../../components/ui/Container.astro';
import Button from '../../components/ui/Button.astro';
import { fetchGraphQL, isWordPressAvailable } from '../../lib/wordpress';
import { GET_POST_BY_SLUG } from '../../lib/queries/posts';
import type { PostResponse, Post } from '../../types';

// Mock posts for static generation
const mockPosts: Record<string, Post> = {
  'pourquoi-choisir-astro-2024': {
    id: '1',
    slug: 'pourquoi-choisir-astro-2024',
    title: 'Pourquoi choisir Astro en 2024 ?',
    content: `
      <p>Astro s'est imposé comme l'un des frameworks les plus innovants de ces dernières années. Conçu pour créer des sites web rapides et orientés contenu, il offre une approche unique qui séduit de plus en plus de développeurs.</p>

      <h2>Le concept d'Islands Architecture</h2>
      <p>Astro introduit le concept d'"Islands Architecture" (architecture en îlots). L'idée est simple mais puissante : par défaut, Astro génère du HTML statique sans JavaScript. Les composants interactifs sont isolés en "îlots" qui s'hydratent indépendamment.</p>

      <p>Cette approche offre plusieurs avantages :</p>
      <ul>
        <li><strong>Performance exceptionnelle</strong> : moins de JavaScript = site plus rapide</li>
        <li><strong>SEO optimisé</strong> : contenu HTML statique indexable</li>
        <li><strong>Flexibilité</strong> : utilisez React, Vue, Svelte ou rien du tout</li>
      </ul>

      <h2>Zéro JavaScript par défaut</h2>
      <p>Contrairement à Next.js ou Nuxt qui envoient systématiquement du JavaScript au client, Astro ne le fait que lorsque c'est explicitement demandé. Résultat : des sites ultra-légers avec des scores Lighthouse parfaits.</p>

      <h2>Support multi-frameworks</h2>
      <p>Astro est agnostique : vous pouvez utiliser React, Vue, Svelte, Solid, Preact ou même du vanilla JavaScript dans le même projet. Idéal pour les équipes avec des compétences variées.</p>

      <h2>Quand utiliser Astro ?</h2>
      <p>Astro est parfait pour :</p>
      <ul>
        <li>Sites vitrines et portfolios</li>
        <li>Blogs et sites de documentation</li>
        <li>Sites e-commerce statiques</li>
        <li>Landing pages optimisées</li>
      </ul>

      <h2>Conclusion</h2>
      <p>Si vous cherchez à créer un site rapide, SEO-friendly et facile à maintenir, Astro est un excellent choix en 2024. C'est d'ailleurs le framework que nous utilisons pour ce site !</p>
    `,
    date: '2024-01-15',
    featuredImage: undefined,
    categories: { nodes: [{ id: '1', name: 'Développement', slug: 'developpement' }] },
    author: { node: { name: 'Alexandre Martin', avatar: undefined } },
  },
  'wordpress-headless-guide-complet': {
    id: '2',
    slug: 'wordpress-headless-guide-complet',
    title: 'WordPress Headless : Le guide complet',
    content: `
      <p>WordPress headless combine le meilleur des deux mondes : la puissance de WordPress comme CMS et les performances d'un frontend moderne. Voici comment ça fonctionne.</p>

      <h2>Qu'est-ce que WordPress Headless ?</h2>
      <p>Dans une configuration "headless", WordPress ne gère que le contenu (le "corps") tandis qu'un frontend séparé (la "tête") s'occupe de l'affichage. La communication se fait via API REST ou GraphQL.</p>

      <h2>Les avantages</h2>
      <ul>
        <li><strong>Performance</strong> : frontend statique ultra-rapide</li>
        <li><strong>Sécurité</strong> : WordPress n'est pas exposé publiquement</li>
        <li><strong>Flexibilité</strong> : liberté totale sur le frontend</li>
        <li><strong>Scalabilité</strong> : CDN pour le frontend, serveur pour le CMS</li>
      </ul>

      <h2>L'architecture typique</h2>
      <p>Une architecture WordPress headless comprend généralement :</p>
      <ul>
        <li>WordPress + WPGraphQL sur un serveur dédié</li>
        <li>Frontend Astro/Next.js déployé sur Vercel ou Cloudflare</li>
        <li>Webhooks pour le rebuild automatique</li>
      </ul>

      <h2>WPGraphQL : l'API idéale</h2>
      <p>WPGraphQL transforme WordPress en API GraphQL. Contrairement à REST, vous demandez exactement les données dont vous avez besoin, rien de plus.</p>

      <h2>Exemple de requête</h2>
      <pre><code>query GetPosts {
  posts(first: 10) {
    nodes {
      title
      slug
      excerpt
      featuredImage {
        node {
          sourceUrl
        }
      }
    }
  }
}</code></pre>

      <h2>Conclusion</h2>
      <p>WordPress headless est idéal pour les projets nécessitant performance et flexibilité tout en conservant une gestion de contenu familière. N'hésitez pas à nous contacter pour discuter de votre projet !</p>
    `,
    date: '2024-01-10',
    featuredImage: undefined,
    categories: { nodes: [{ id: '2', name: 'WordPress', slug: 'wordpress' }] },
    author: { node: { name: 'Alexandre Martin', avatar: undefined } },
  },
  'optimiser-core-web-vitals': {
    id: '3',
    slug: 'optimiser-core-web-vitals',
    title: 'Comment optimiser vos Core Web Vitals',
    content: `
      <p>Les Core Web Vitals sont devenus un facteur de ranking Google. Voici comment les optimiser pour améliorer votre SEO et l'expérience utilisateur.</p>

      <h2>Les 3 métriques clés</h2>
      <ul>
        <li><strong>LCP (Largest Contentful Paint)</strong> : temps de chargement du plus grand élément visible. Objectif : &lt; 2.5s</li>
        <li><strong>INP (Interaction to Next Paint)</strong> : réactivité aux interactions. Objectif : &lt; 200ms</li>
        <li><strong>CLS (Cumulative Layout Shift)</strong> : stabilité visuelle. Objectif : &lt; 0.1</li>
      </ul>

      <h2>Optimiser le LCP</h2>
      <ul>
        <li>Optimisez les images (WebP, lazy loading, dimensions)</li>
        <li>Préchargez les ressources critiques</li>
        <li>Utilisez un CDN</li>
        <li>Minimisez le CSS et JS bloquants</li>
      </ul>

      <h2>Améliorer l'INP</h2>
      <ul>
        <li>Réduisez le JavaScript sur le thread principal</li>
        <li>Divisez les longues tâches</li>
        <li>Utilisez requestIdleCallback pour les tâches non urgentes</li>
      </ul>

      <h2>Réduire le CLS</h2>
      <ul>
        <li>Définissez toujours width/height pour les images</li>
        <li>Réservez l'espace pour les contenus dynamiques</li>
        <li>Évitez d'insérer du contenu au-dessus du fold</li>
      </ul>

      <h2>Outils de mesure</h2>
      <ul>
        <li>Lighthouse dans Chrome DevTools</li>
        <li>PageSpeed Insights</li>
        <li>Search Console (rapport Core Web Vitals)</li>
        <li>web.dev/measure</li>
      </ul>

      <h2>Conclusion</h2>
      <p>L'optimisation des Core Web Vitals demande une approche méthodique. Commencez par mesurer, identifiez les problèmes, puis corrigez-les un par un. Les gains sont significatifs tant pour le SEO que pour l'expérience utilisateur.</p>
    `,
    date: '2024-01-05',
    featuredImage: undefined,
    categories: { nodes: [{ id: '3', name: 'Performance', slug: 'performance' }] },
    author: { node: { name: 'Sophie Bernard', avatar: undefined } },
  },
};

const { slug } = Astro.params;

let post: Post | null = null;
let isFromWordPress = false;

try {
  const wpAvailable = await isWordPressAvailable();
  if (wpAvailable) {
    const data = await fetchGraphQL<PostResponse>(GET_POST_BY_SLUG, { slug });
    if (data.post) {
      post = data.post;
      isFromWordPress = true;
    }
  }
} catch (error) {
  console.error('Error fetching post:', error);
}

// Use mock data if no WordPress data
if (!post && slug && mockPosts[slug]) {
  post = mockPosts[slug];
}

if (!post) {
  return Astro.redirect('/blog');
}

function formatDate(dateString: string): string {
  return new Date(dateString).toLocaleDateString('fr-FR', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  });
}

function getReadingTime(content?: string): string {
  if (!content) return '3 min';
  const wordsPerMinute = 200;
  const words = content.replace(/<[^>]*>/g, '').split(/\s+/).length;
  const minutes = Math.ceil(words / wordsPerMinute);
  return `${minutes} min`;
}

// Related posts (mock)
const relatedPosts = Object.values(mockPosts)
  .filter(p => p.slug !== slug)
  .slice(0, 3);

// Table of contents (extract h2s from content)
function extractHeadings(content: string): { id: string; text: string }[] {
  const regex = /<h2[^>]*>(.*?)<\/h2>/gi;
  const headings: { id: string; text: string }[] = [];
  let match;
  while ((match = regex.exec(content)) !== null) {
    const text = match[1].replace(/<[^>]*>/g, '');
    const id = text.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
    headings.push({ id, text });
  }
  return headings;
}

const headings = post.content ? extractHeadings(post.content) : [];

// Add IDs to headings in content
let processedContent = post.content || '';
headings.forEach(({ id, text }) => {
  processedContent = processedContent.replace(
    new RegExp(`<h2[^>]*>${text.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')}</h2>`, 'i'),
    `<h2 id="${id}">${text}</h2>`
  );
});
---

<BaseLayout
  title={post.title}
  description={post.excerpt || `Lisez notre article : ${post.title}`}
  type="article"
>
  <!-- Hero Section -->
  <article>
    <header class="relative pt-32 pb-16 overflow-hidden">
      <!-- Background -->
      <div class="absolute inset-0 grid-bg opacity-30"></div>
      <div class="absolute top-0 left-0 w-[600px] h-[600px] bg-gradient-to-br from-accent-secondary/20 via-accent-primary/10 to-transparent rounded-full blur-3xl"></div>

      <Container class="relative z-10">
        <!-- Back Link -->
        <a
          href="/blog"
          class="inline-flex items-center gap-2 text-text-muted hover:text-white transition-colors mb-8 group reveal"
        >
          <svg class="w-5 h-5 transform group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
          <span>Retour au blog</span>
        </a>

        <div class="max-w-4xl">
          <!-- Category & Date -->
          <div class="flex flex-wrap items-center gap-4 mb-6 reveal">
            {post.categories?.nodes?.[0] && (
              <span class="px-4 py-1.5 rounded-full bg-gradient-to-r from-accent-primary/20 to-accent-secondary/20 border border-accent-primary/30 text-sm font-medium text-accent-primary">
                {post.categories.nodes[0].name}
              </span>
            )}
            <div class="flex items-center gap-2 text-text-muted text-sm">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              {formatDate(post.date)}
            </div>
            <div class="flex items-center gap-2 text-text-muted text-sm">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              {getReadingTime(post.content)} de lecture
            </div>
          </div>

          <!-- Title -->
          <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold tracking-tight mb-8 reveal">
            {post.title}
          </h1>

          <!-- Author -->
          {post.author?.node && (
            <div class="flex items-center gap-4 reveal">
              <div class="w-14 h-14 rounded-full bg-gradient-to-br from-accent-primary/30 to-accent-secondary/30 flex items-center justify-center border-2 border-accent-primary/30">
                <span class="text-lg font-semibold text-accent-primary">
                  {post.author.node.name.split(' ').map(n => n[0]).join('')}
                </span>
              </div>
              <div>
                <p class="font-semibold text-lg">{post.author.node.name}</p>
                <p class="text-text-muted">Auteur</p>
              </div>
            </div>
          )}
        </div>
      </Container>
    </header>

    <!-- Featured Image -->
    <section class="pb-16">
      <Container>
        <div class="max-w-5xl mx-auto reveal">
          <div class="aspect-[21/9] rounded-3xl overflow-hidden border border-white/10 shadow-2xl shadow-black/50">
            {post.featuredImage?.node ? (
              <img
                src={post.featuredImage.node.sourceUrl}
                alt={post.featuredImage.node.altText || post.title}
                class="w-full h-full object-cover"
              />
            ) : (
              <div class="w-full h-full bg-gradient-to-br from-accent-primary/20 via-accent-secondary/10 to-bg-tertiary flex items-center justify-center">
                <div class="w-32 h-32 rounded-3xl bg-gradient-to-br from-accent-primary/30 to-accent-secondary/30 flex items-center justify-center">
                  <svg class="w-16 h-16 text-accent-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
                  </svg>
                </div>
              </div>
            )}
          </div>
        </div>
      </Container>
    </section>

    <!-- Content Section -->
    <section class="py-12">
      <Container>
        <div class="grid lg:grid-cols-4 gap-12 max-w-6xl mx-auto">
          <!-- Table of Contents (Sticky) -->
          {headings.length > 0 && (
            <aside class="hidden lg:block">
              <div class="sticky top-32 reveal">
                <div class="p-6 rounded-2xl bg-white/5 border border-white/10 backdrop-blur-sm">
                  <h3 class="text-sm font-semibold uppercase tracking-wider text-text-muted mb-4 flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
                    </svg>
                    Sommaire
                  </h3>
                  <nav class="space-y-2">
                    {headings.map((heading) => (
                      <a
                        href={`#${heading.id}`}
                        class="block text-sm text-text-secondary hover:text-accent-primary transition-colors py-1 border-l-2 border-white/10 hover:border-accent-primary pl-3"
                      >
                        {heading.text}
                      </a>
                    ))}
                  </nav>
                </div>
              </div>
            </aside>
          )}

          <!-- Main Content -->
          <div class:list={['lg:col-span-3', headings.length === 0 && 'lg:col-span-4 max-w-3xl mx-auto']}>
            <div
              class="prose prose-invert prose-lg max-w-none reveal
                     prose-headings:font-bold prose-headings:text-text-primary prose-headings:scroll-mt-24
                     prose-h2:text-3xl prose-h2:mt-16 prose-h2:mb-6 prose-h2:pb-4 prose-h2:border-b prose-h2:border-white/10
                     prose-h3:text-xl prose-h3:mt-8 prose-h3:mb-4
                     prose-p:text-text-secondary prose-p:leading-relaxed prose-p:mb-6
                     prose-li:text-text-secondary prose-li:marker:text-accent-primary
                     prose-ul:my-6 prose-ul:space-y-3
                     prose-ol:my-6 prose-ol:space-y-3
                     prose-a:text-accent-primary prose-a:no-underline hover:prose-a:underline
                     prose-strong:text-text-primary prose-strong:font-semibold
                     prose-code:text-accent-primary prose-code:bg-bg-tertiary prose-code:px-2 prose-code:py-1 prose-code:rounded-md prose-code:text-sm
                     prose-pre:bg-bg-tertiary prose-pre:border prose-pre:border-white/10 prose-pre:rounded-2xl prose-pre:p-6
                     prose-blockquote:border-accent-primary prose-blockquote:bg-white/5 prose-blockquote:rounded-r-xl prose-blockquote:py-4 prose-blockquote:px-6 prose-blockquote:not-italic"
              set:html={processedContent}
            />

            <!-- Share Section -->
            <div class="mt-16 pt-8 border-t border-white/10 reveal">
              <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-6">
                <div>
                  <p class="font-semibold mb-1">Vous avez aimé cet article ?</p>
                  <p class="text-text-muted text-sm">Partagez-le sur vos réseaux sociaux</p>
                </div>
                <div class="flex items-center gap-3">
                  <a
                    href={`https://twitter.com/intent/tweet?text=${encodeURIComponent(post.title)}&url=${Astro.url}`}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="w-12 h-12 flex items-center justify-center rounded-xl bg-white/5 border border-white/10 hover:bg-accent-primary/20 hover:border-accent-primary/50 transition-all group"
                    aria-label="Partager sur Twitter"
                  >
                    <svg class="w-5 h-5 text-text-muted group-hover:text-accent-primary transition-colors" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
                    </svg>
                  </a>
                  <a
                    href={`https://www.linkedin.com/sharing/share-offsite/?url=${Astro.url}`}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="w-12 h-12 flex items-center justify-center rounded-xl bg-white/5 border border-white/10 hover:bg-accent-primary/20 hover:border-accent-primary/50 transition-all group"
                    aria-label="Partager sur LinkedIn"
                  >
                    <svg class="w-5 h-5 text-text-muted group-hover:text-accent-primary transition-colors" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" />
                    </svg>
                  </a>
                  <button
                    onclick="navigator.clipboard.writeText(window.location.href); this.querySelector('span').textContent = 'Copié !'; setTimeout(() => this.querySelector('span').textContent = 'Copier le lien', 2000)"
                    class="flex items-center gap-2 px-4 h-12 rounded-xl bg-white/5 border border-white/10 hover:bg-accent-primary/20 hover:border-accent-primary/50 transition-all group"
                  >
                    <svg class="w-5 h-5 text-text-muted group-hover:text-accent-primary transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                    </svg>
                    <span class="text-sm text-text-muted group-hover:text-accent-primary transition-colors">Copier le lien</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- Author Bio -->
            {post.author?.node && (
              <div class="mt-12 p-8 rounded-2xl bg-gradient-to-br from-accent-primary/10 to-accent-secondary/10 border border-accent-primary/20 reveal">
                <div class="flex items-start gap-6">
                  <div class="w-20 h-20 rounded-2xl bg-gradient-to-br from-accent-primary/30 to-accent-secondary/30 flex items-center justify-center flex-shrink-0 border-2 border-accent-primary/30">
                    <span class="text-2xl font-bold text-accent-primary">
                      {post.author.node.name.split(' ').map(n => n[0]).join('')}
                    </span>
                  </div>
                  <div>
                    <h3 class="font-semibold text-xl mb-2">{post.author.node.name}</h3>
                    <p class="text-text-secondary mb-4">
                      Expert en développement web et passionné par les nouvelles technologies.
                      Partage régulièrement ses connaissances à travers des articles et tutoriels.
                    </p>
                    <div class="flex items-center gap-3">
                      <a href="#" class="text-accent-primary hover:underline text-sm">Tous ses articles</a>
                      <span class="text-text-muted">•</span>
                      <a href="#" class="text-accent-primary hover:underline text-sm">LinkedIn</a>
                    </div>
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>
      </Container>
    </section>
  </article>

  <!-- Related Posts -->
  {relatedPosts.length > 0 && (
    <section class="py-24 bg-bg-secondary/50">
      <Container>
        <div class="text-center mb-12 reveal">
          <h2 class="text-3xl md:text-4xl font-bold mb-4">
            Articles <span class="bg-gradient-to-r from-accent-primary to-accent-secondary bg-clip-text text-transparent">similaires</span>
          </h2>
          <p class="text-text-secondary">Continuez votre lecture avec ces articles</p>
        </div>

        <div class="grid md:grid-cols-3 gap-8">
          {relatedPosts.map((relatedPost, index) => (
            <a
              href={`/blog/${relatedPost.slug}`}
              class="group reveal"
              style={`animation-delay: ${index * 0.1}s`}
            >
              <article class="h-full rounded-2xl overflow-hidden bg-bg-primary border border-white/10 hover:border-accent-primary/50 transition-all duration-500">
                <div class="aspect-video bg-gradient-to-br from-bg-tertiary to-bg-secondary flex items-center justify-center">
                  <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-accent-primary/20 to-accent-secondary/20 flex items-center justify-center">
                    <svg class="w-6 h-6 text-accent-primary/50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
                    </svg>
                  </div>
                </div>
                <div class="p-6">
                  <div class="flex items-center gap-3 mb-3">
                    {relatedPost.categories?.nodes?.[0] && (
                      <span class="px-2.5 py-1 rounded-full bg-accent-primary/10 border border-accent-primary/20 text-xs text-accent-primary">
                        {relatedPost.categories.nodes[0].name}
                      </span>
                    )}
                    <span class="text-text-muted text-xs">{formatDate(relatedPost.date)}</span>
                  </div>
                  <h3 class="font-semibold text-lg group-hover:text-white transition-colors line-clamp-2">
                    {relatedPost.title}
                  </h3>
                </div>
              </article>
            </a>
          ))}
        </div>
      </Container>
    </section>
  )}

  <!-- CTA Section -->
  <section class="py-24">
    <Container>
      <div class="max-w-3xl mx-auto text-center reveal">
        <h2 class="text-3xl md:text-4xl font-bold mb-6">
          Besoin d'aide pour votre projet ?
        </h2>
        <p class="text-text-secondary text-lg mb-8">
          Notre équipe d'experts est là pour transformer vos idées en réalité.
          Contactez-nous pour en discuter.
        </p>
        <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
          <Button href="/contact" size="lg" class="group">
            <span>Nous contacter</span>
            <svg class="w-5 h-5 ml-2 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </Button>
          <Button href="/projets" variant="outline" size="lg">
            Voir nos réalisations
          </Button>
        </div>
      </div>
    </Container>
  </section>
</BaseLayout>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .reveal {
    opacity: 0;
    transform: translateY(20px);
  }

  .reveal.visible {
    opacity: 1;
    transform: translateY(0);
    transition: opacity 0.6s ease, transform 0.6s ease;
  }
</style>

<script>
  // Reveal animations
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
      }
    });
  }, observerOptions);

  document.querySelectorAll('.reveal').forEach(el => {
    observer.observe(el);
  });

  // Smooth scroll for TOC links
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href') as string);
      if (target) {
        target.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }
    });
  });
</script>
